{"version":3,"sources":["helpers/number.ts","models/CartContent.ts","models/Product.ts","models/ProductSearch.ts","models/index.ts","components/ProductDiscount/ProductDiscount.tsx","components/ProductPrice/ProductPrice.tsx","helpers/product.ts","config/http.ts","repositories/ProductRepository.ts","repositories/Repository.ts","repositories/index.ts","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js","components/ProductListItem/ProductListItem.tsx","hooks/useProductList.ts","helpers/debounce.ts","views/ProductListing/ProductListing.tsx"],"names":["formatNumber","x","undefined","r","toString","pattern","test","replace","calcDiscountRate","originPrice","discountPrice","Math","floor","CartContent","product","quantity","Product","sku","name","url","seller","brand","status","objective","productType","images","price","productLine","stocks","totalAvailable","isBundle","bundleProducts","parentBundles","totalAvailableByStocks","displayName","color","tags","promotionPrices","promotions","flashSales","attributeSet","categories","magentoId","seoInfo","rating","allActiveFlashSales","productGroup","attributes","saleCategories","taxOut","taxOutCode","attributeGroups","warranty","createdAt","salePoint","importPrice","recommendMethod","ProductSearch","channel","terminal","saleStatuses","_sort","_order","_page","_limit","q","ProductDiscount","props","discountRate","className","sellPrice","ProductPrice","supplierSalePrice","getProductPath","slugify","toLowerCase","httpConfig","withCredentials","baseURL","headers","search","productSearch","a","async","http","get","params","then","response","data","result","config","this","axios","create","defaults","_defineProperty","obj","key","value","Object","defineProperty","enumerable","configurable","writable","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","push","apply","_objectSpread2","target","i","arguments","length","source","forEach","getOwnPropertyDescriptors","defineProperties","ProductListItem","role","href","src","alt","REPLACE","CONCAT","LOAD_PAGE","reducer","state","action","type","list","loadedPages","useProductList","f","React","useState","setSearch","loading","setLoading","useReducer","dispatch","total","setTotal","hasMore","handleLoadList","useCallback","productRepository","rootObject","extra","totalItems","products","finally","handleUpdateSearch","handleLoadMore","window","innerHeight","document","documentElement","scrollTop","offsetHeight","page","newSearch","lodashDebounce","useEffect","ProductListing","addEventListener","removeEventListener","listItems","useMemo","map","handleSearch","event","handleGoBack","message","info","onClick","defaultValue","onChange","placeholder"],"mappings":"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","file":"static/js/6.758b828c.chunk.js","sourcesContent":["export function formatNumber(x: number | null | undefined): string {\n  if (x === null || x === undefined) {\n    return '';\n  }\n  let r: string = x.toString();\n  const pattern = /(-?\\d+)(\\d{3})/;\n  while (pattern.test(r)) {\n    r = r.replace(pattern, '$1.$2');\n  }\n  return r;\n}\n\nexport function calcDiscountRate(originPrice: number, discountPrice: number): number {\n  return Math.floor((originPrice - discountPrice) / originPrice * 100);\n}\n","import {Product} from 'models/Product';\n\nexport class CartContent {\n  public product?: Product;\n\n  public quantity: number = 0;\n}\n","import {\n  Attribute,\n  AttributeGroup,\n  AttributeSet,\n  Brand,\n  Category,\n  Color,\n  Image,\n  Objective,\n  ParentBundle,\n  Price,\n  Product as IProduct,\n  ProductLine,\n  ProductType,\n  Promotion,\n  PromotionPrice,\n  Rating,\n  SaleCategory,\n  Seller,\n  SeoInfo,\n  Status,\n  TotalAvailableByStock,\n  Warranty,\n} from 'teko-product-discovery';\n\nexport class Product implements IProduct {\n  public sku?: string;\n\n  public name?: string;\n\n  public url?: string;\n\n  public seller?: Seller;\n\n  public brand?: Brand;\n\n  public status?: Status;\n\n  public objective?: Objective;\n\n  public productType?: ProductType;\n\n  public images?: Image[];\n\n  public price?: Price;\n\n  public productLine?: ProductLine;\n\n  public stocks?: any[];\n\n  public totalAvailable?: number;\n\n  public isBundle?: boolean;\n\n  public bundleProducts?: any;\n\n  public parentBundles?: ParentBundle[];\n\n  public totalAvailableByStocks?: TotalAvailableByStock[];\n\n  public displayName?: string;\n\n  public color?: Color;\n\n  public tags?: any[];\n\n  public promotionPrices?: PromotionPrice[];\n\n  public promotions?: Promotion[];\n\n  public flashSales?: any[];\n\n  public attributeSet?: AttributeSet;\n\n  public categories?: Category[];\n\n  public magentoId?: number;\n\n  public seoInfo?: SeoInfo;\n\n  public rating?: Rating;\n\n  public allActiveFlashSales?: any[];\n\n  public productGroup?: any;\n\n  public attributes?: Attribute[];\n\n  public saleCategories?: SaleCategory[];\n\n  public taxOut?: number;\n\n  public taxOutCode?: string;\n\n  public attributeGroups?: AttributeGroup[];\n\n  public warranty?: Warranty;\n\n  public createdAt?: Date;\n\n  public salePoint?: number;\n\n  public importPrice?: any;\n\n  public recommendMethod?: any;\n}\n","export class ProductSearch {\n  public saleCategories?: number = 613;\n\n  public channel?: string = 'pv_online';\n\n  public terminal?: string = 'phongvu';\n\n  public saleStatuses?: string = 'hang_ban,hang_dat_truoc,hang_sap_het,hang_moi,hang_trung_bay,hang_thanh_ly';\n\n  // tslint:disable-next-line:variable-name\n  public _sort?: string = 'saleStatuses||hang_ban|hang_dat_truoc|hang_sap_het|hang_moi||hang_trung_bay|hang_thanh_ly||ngung_kinh_doanh';\n\n  // tslint:disable-next-line:variable-name\n  public _order?: 'asc' | 'desc' = 'asc';\n\n  // tslint:disable-next-line:variable-name\n  public _page: number = 1;\n\n  // tslint:disable-next-line:variable-name\n  public _limit: number = 10;\n\n  public q?: string;\n}\n","export {CartContent} from './CartContent';\n\nexport {Product} from './Product';\n\nexport {ProductSearch} from './ProductSearch';\n","import {formatNumber} from 'helpers/number';\nimport {Product} from 'models';\nimport React from 'react';\nimport './ProductDiscount.scss';\n\ninterface ProductDiscountProps {\n  product: Product;\n\n  discountRate: number;\n}\n\nfunction ProductDiscount(props: ProductDiscountProps) {\n  const {product, discountRate} = props;\n\n  return discountRate > 0 ? (\n    <div className=\"product-discount\">\n      <div className=\"product-discount-price\">\n        {formatNumber(product.price?.sellPrice)}\n        <sup>đ</sup>\n      </div>\n      <div className=\"product-discount-rate\">\n        {`-${discountRate}%`}\n      </div>\n    </div>\n  ) : null;\n}\n\nexport default ProductDiscount;\n","import {formatNumber} from 'helpers/number';\nimport {Product} from 'models';\nimport React from 'react';\nimport './ProductPrice.scss';\n\ninterface ProductPriceProps {\n  product: Product;\n}\n\nfunction ProductPrice(props: ProductPriceProps) {\n  const {product} = props;\n  return product?.price?.supplierSalePrice ? (\n    <div className=\"product-price\">\n      {formatNumber(product.price?.supplierSalePrice)}\n      <sup>đ</sup>\n    </div>\n  ) : null;\n}\n\nexport default ProductPrice;\n","import {Product} from 'models';\nimport slugify from 'slugify';\n\nexport function getProductPath(product: Product) {\n  return `${slugify(product?.name?.toLowerCase() || '')}-pro.${product?.sku}`;\n}\n","import {AxiosRequestConfig} from 'axios';\n\nexport const httpConfig: AxiosRequestConfig = {\n  withCredentials: true,\n  baseURL: 'https://listing.stage.tekoapis.net',\n  headers: {\n    'Content-Type': 'application/json',\n  },\n};\n","import {AxiosResponse} from 'axios';\nimport {httpConfig} from 'config/http';\nimport {Product, ProductSearch} from 'models';\nimport {Repository} from 'repositories/Repository';\nimport {RootObject} from 'teko-product-discovery';\n\nexport class ProductRepository extends Repository {\n  constructor() {\n    super(httpConfig);\n  }\n\n  public search = async (productSearch: ProductSearch): Promise<RootObject> => {\n    return this.http\n      .get('/api/search/', {\n        params: productSearch,\n      })\n      .then((response: AxiosResponse<RootObject>) => {\n        return response.data;\n      });\n  };\n\n  public get = async (sku: string, productSearch: ProductSearch): Promise<Product> => {\n    const {data: {result: {product}}} = await this.http\n      .get(`/api/products/${sku}`, {\n        params: productSearch,\n      });\n    return product;\n  };\n}\n\nexport default new ProductRepository();\n","import axios, {AxiosInstance, AxiosRequestConfig} from 'axios';\nimport {httpConfig} from 'config/http';\n\nexport class Repository {\n  protected http: AxiosInstance;\n\n  constructor(config?: AxiosRequestConfig) {\n    this.http = axios.create(httpConfig);\n  }\n\n  public setBaseURL(url: string) {\n    this.http.defaults.baseURL = url;\n  }\n}\n","export {default as productRepository} from 'repositories/ProductRepository';\n","export default function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}","import defineProperty from \"./defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nexport default function _objectSpread2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}","import ProductDiscount from 'components/ProductDiscount/ProductDiscount';\nimport ProductPrice from 'components/ProductPrice/ProductPrice';\nimport {calcDiscountRate} from 'helpers/number';\nimport {getProductPath} from 'helpers/product';\nimport {Product} from 'models';\nimport React from 'react';\nimport './ProductListItem.scss';\n\ninterface ProductListItemProps {\n  product: Product;\n}\n\nfunction ProductListItem(props: ProductListItemProps) {\n  const {product} = props;\n  const discountRate: number = (product?.price?.supplierSalePrice && product?.price?.sellPrice) ?\n    calcDiscountRate(product?.price.supplierSalePrice, product?.price?.sellPrice) :\n    0;\n  return (\n    <a role=\"menuitem\" href={getProductPath(product)} className=\"product-list-item\">\n      <li>\n        <div className=\"product-picture\">\n          <img src={(product?.images && product?.images.length > 0) ? product?.images[0].url : ''} alt=\"\"/>\n        </div>\n        <div className=\"product-info\">\n            <span className=\"product-name\">\n              {product?.name}\n            </span>\n          <ProductPrice product={product}/>\n          <ProductDiscount product={product} discountRate={discountRate}/>\n        </div>\n      </li>\n    </a>\n  );\n}\n\nexport default ProductListItem;\n","import {debounce} from 'helpers/debounce';\nimport {Product, ProductSearch} from 'models';\nimport React, {Reducer} from 'react';\nimport {productRepository} from 'repositories';\nimport {RootObject} from 'teko-product-discovery';\n\nexport type ProductListResult = [\n  Product[],\n  number,\n  ProductSearch,\n  (search: ProductSearch) => void,\n  boolean,\n  boolean,\n  () => Promise<void>,\n];\n\ninterface ProductListState {\n  list: Product[];\n\n  loadedPages: { [key: number]: boolean };\n}\n\ninterface Action {\n  type: string;\n\n  data: any;\n}\n\nconst REPLACE: string = 'REPLACE';\nconst CONCAT: string = 'CONCAT';\nconst LOAD_PAGE: string = 'LOAD_PAGE';\n\nfunction reducer(state: ProductListState, action: Action) {\n  switch (action.type) {\n    case REPLACE:\n      state.list = action.data;\n      break;\n\n    case CONCAT:\n      state.list = [\n        ...state.list,\n        ...action.data,\n      ];\n      break;\n\n    case LOAD_PAGE:\n      state.loadedPages[action.data] = true;\n      break;\n  }\n  return {...state};\n}\n\nexport function useProductList(): ProductListResult {\n  const [search, setSearch] = React.useState<ProductSearch>(new ProductSearch());\n  const [loading, setLoading] = React.useState<boolean>(false);\n  const [{list, loadedPages}, dispatch] = React.useReducer<Reducer<ProductListState, Action>>(reducer, {\n    list: [],\n    loadedPages: {},\n  });\n\n  const [total, setTotal] = React.useState<number>(0);\n\n  const hasMore: boolean = total > search._page * search._limit;\n\n  const handleLoadList = React.useCallback(\n    async (productSearch?: ProductSearch, action: string = CONCAT) => {\n      setLoading(true);\n      dispatch({\n        type: LOAD_PAGE,\n        data: productSearch?._page || 1,\n      });\n      await productRepository\n        .search(productSearch || new ProductSearch())\n        .then((rootObject: RootObject) => {\n          if (rootObject.extra?.totalItems && rootObject.result?.products) {\n            if (productSearch) {\n              setSearch(productSearch);\n            }\n            const products: Product[] = rootObject.result?.products;\n            setTotal(rootObject.extra?.totalItems);\n            dispatch({\n              type: action,\n              data: products,\n            });\n          }\n        })\n        .finally(() => {\n          setLoading(false);\n        });\n    },\n    [],\n  );\n\n  const handleUpdateSearch = React.useCallback(\n    (search: ProductSearch) => {\n      handleLoadList(search, REPLACE);\n    },\n    [handleLoadList],\n  );\n\n  const handleLoadMore = React.useCallback(\n    debounce(async () => {\n      if (loading) {\n        return;\n      }\n      if (\n        window.innerHeight + document.documentElement.scrollTop\n        === document.documentElement.offsetHeight\n      ) {\n        const page: number = search._page + 1;\n        if (!loadedPages[page] && !loading) {\n          const newSearch: ProductSearch = {\n            ...search,\n            _page: page,\n          };\n          await handleLoadList(newSearch);\n        }\n      }\n    }),\n    [loading, loadedPages],\n  );\n\n  React.useEffect(\n    () => {\n      handleLoadList();\n    },\n    [handleLoadList],\n  );\n\n  return [list, total, search, handleUpdateSearch, loading, hasMore, handleLoadMore];\n}\n","import lodashDebounce from 'lodash/debounce';\n\nexport function debounce(f: (...params: any[]) => any) {\n  return lodashDebounce(f, 400);\n}\n","import message from 'antd/lib/message';\nimport Spin from 'antd/lib/spin';\nimport ProductListItem from 'components/ProductListItem/ProductListItem';\nimport {useProductList} from 'hooks/useProductList';\nimport {Product} from 'models';\nimport React, {ChangeEvent} from 'react';\nimport './ProductListing.scss';\n\nfunction ProductListing() {\n  const [\n    list,\n    ,\n    search,\n    setSearch,\n    ,\n    hasMore,\n    handleLoadMore,\n  ] = useProductList();\n\n  React.useEffect(\n    () => {\n      window.addEventListener('scroll', handleLoadMore);\n      return () => {\n        window.removeEventListener('scroll', handleLoadMore);\n      };\n    },\n    [handleLoadMore],\n  );\n\n  const listItems = React.useMemo(\n    () => list.map((product: Product) => (\n      <ProductListItem product={product} key={product.sku}/>\n    )),\n    [list],\n  );\n\n  const handleSearch = React.useCallback(\n    (event: ChangeEvent<HTMLInputElement>) => {\n      setSearch({\n        ...search,\n        q: event.target.value,\n        _page: 1,\n      });\n    },\n    [setSearch, search],\n  );\n\n  const handleGoBack = React.useCallback(\n    () => {\n      message.info('Đây là bài test, chỉ có một module, vì thế nút back này không dẫn đi đâu cả :D');\n    },\n    [],\n  );\n\n  return (\n    <div className=\"view mobile-view products\">\n      <div className=\"header\">\n        <button type=\"button\" className=\"btn btn-link btn-go-back\" onClick={handleGoBack}>\n          <img className=\"history-back-button\" src=\"/images/arrow-back.png\" alt=\"\"/>\n        </button>\n        <div className=\"input-group\">\n          <div className=\"input-group-prepend\">\n            <img src=\"/images/search.png\" alt=\"\"/>\n          </div>\n          <input type=\"text\"\n                 className=\"form-control search\"\n                 defaultValue={search.q}\n                 onChange={handleSearch}\n                 placeholder=\"Nhập tên, mã sản phẩm\"\n          />\n        </div>\n      </div>\n      <ul className=\"product-list\">\n        {listItems}\n        {hasMore && (\n          <div className=\"infinite-scroll-loading\">\n            <Spin/>\n          </div>\n        )}\n      </ul>\n    </div>\n  );\n}\n\nexport default ProductListing;\n"],"sourceRoot":""}